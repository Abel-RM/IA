(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17691,        352]
NotebookOptionsPosition[     17264,        336]
NotebookOutlinePosition[     17608,        351]
CellTagsIndexPosition[     17565,        348]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"dataOriginal", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<C:\\\\Users\\\\Abel\\\\Downloads\\\\iris.txt\>\"", ",", 
     "\"\<Data\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"RandomSample", "[", "dataOriginal", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data30Percent", "=", 
   RowBox[{"Take", "[", 
    RowBox[{"data", ",", "45"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", "data", "]"}], ",", "105"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QueClaseEs", "[", 
     RowBox[{"iris_", ",", "k2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"irisAux", "=", "iris"}], ",", 
        RowBox[{"clases", "=", 
         RowBox[{"{", "}"}]}], ",", "clasesVirginica", ",", 
        "clasesIrisSetosa", ",", "clasesVersicolor", ",", "masCercano", ",", 
        "dataSort", ",", 
        RowBox[{"dataAux", "=", 
         RowBox[{"{", "}"}]}], ",", "result", ",", "lista", ",", "i", ",", 
        "l", ",", 
        RowBox[{"clase", "=", "\"\<\>\""}], ",", "distancia", ",", "media"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dataAux", "=", "data"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "data", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"distancia", "=", " ", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"iris", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "+", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"iris", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "+", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"iris", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "+", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"iris", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "-", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dataAux", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Insert", "[", 
              RowBox[{
               RowBox[{"dataAux", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "distancia", ",", "6"}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dataSort", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"dataAux", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "<", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataSort", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"dataSort", ",", "k2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lista", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"l", "=", "1"}], ",", 
         RowBox[{"l", "\[LessEqual]", "k2"}], ",", 
         RowBox[{"l", "++"}], ",", 
         RowBox[{"lista", " ", "=", 
          RowBox[{"Insert", "[", 
           RowBox[{"lista", ",", 
            RowBox[{"dataSort", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "5"}], "]"}], "]"}], ",", "1"}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"clase", "=", 
        RowBox[{
         RowBox[{"Commonest", "[", "lista", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"clase", " ", "==", 
          RowBox[{"iris", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{"result", " ", "=", "True"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QueClaseSon", "[", 
     RowBox[{"lista_", ",", "k1_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"listaAux", "=", "lista"}], ",", "clase", ",", "j", ",", 
        "clasesBien", ",", "porcentaje"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"clasesBien", "=", "0.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "listaAux", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"QueClaseEs", "[", 
             RowBox[{
              RowBox[{"listaAux", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "k1"}], "]"}], ",", 
            RowBox[{"clasesBien", " ", "=", 
             RowBox[{"clasesBien", " ", "+", "1"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"porcentaje", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"clasesBien", "/", 
           RowBox[{"Length", "[", "listaAux", "]"}]}], ")"}], "*", "100"}]}], 
       ";", "\[IndentingNewLine]", "porcentaje"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"QueClaseSon", "[", 
  RowBox[{"data", ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7831891493880377`*^9, 3.7831891545700417`*^9}, {
   3.783189216969037*^9, 3.783189218884041*^9}, {3.783189265573042*^9, 
   3.78318926947604*^9}, {3.783189329755043*^9, 3.783189643592038*^9}, {
   3.78318970257304*^9, 3.783189738037039*^9}, {3.783189796584038*^9, 
   3.7831898489340363`*^9}, {3.7831899638640356`*^9, 
   3.7831900534710407`*^9}, {3.7831901356180415`*^9, 3.783190215525036*^9}, {
   3.7831902495810385`*^9, 3.7831902954770365`*^9}, {3.78319034731004*^9, 
   3.783190412848035*^9}, {3.7831904458310347`*^9, 3.7831906281750345`*^9}, {
   3.7831906754470387`*^9, 3.7831906755490413`*^9}, {3.783190706010043*^9, 
   3.783190757065035*^9}, {3.783190790854036*^9, 3.783191128096636*^9}, {
   3.7831911885886374`*^9, 3.7831912234666433`*^9}, {3.783191630903642*^9, 
   3.783192066701644*^9}, {3.7831921111406355`*^9, 3.783192225281637*^9}, {
   3.783192267809637*^9, 3.783192343394637*^9}, {3.783192383507636*^9, 
   3.7831925504006367`*^9}, {3.7831925842696443`*^9, 
   3.7831926254816356`*^9}, {3.7831926688686357`*^9, 3.783192692945642*^9}, {
   3.7831927680576353`*^9, 3.783192854768639*^9}, {3.783192889563657*^9, 
   3.783192937348643*^9}, {3.7831929678936357`*^9, 3.7831931104156446`*^9}, {
   3.783193145016641*^9, 3.783193201488655*^9}, 3.7831932865106373`*^9, {
   3.7831933213326354`*^9, 3.783193321521634*^9}, {3.7831933548556376`*^9, 
   3.783193374016635*^9}, {3.78319698051793*^9, 3.783197227552534*^9}, {
   3.7831972788375406`*^9, 3.7831972868415365`*^9}, {3.7831973198605413`*^9, 
   3.7831973676225343`*^9}, {3.7831981019314213`*^9, 
   3.7831981432504253`*^9}, {3.7831982082854156`*^9, 
   3.7831982132564163`*^9}, {3.7831982532384233`*^9, 
   3.7831983179664187`*^9}, {3.7831983895494165`*^9, 
   3.7831983927444215`*^9}, {3.7831986697704163`*^9, 
   3.7831987812154236`*^9}, {3.783198885850422*^9, 3.7831992239464192`*^9}, {
   3.7831992558834224`*^9, 3.783199307390423*^9}, {3.7831994270894184`*^9, 
   3.7831995961214237`*^9}, {3.7831996292854156`*^9, 3.7831996626054173`*^9},
    {3.7831996971614156`*^9, 3.783199744765416*^9}, {3.783199779185257*^9, 
   3.7832000829132586`*^9}, {3.7832001251042595`*^9, 3.783200172310255*^9}, {
   3.783200228143258*^9, 3.7832002297362585`*^9}, {3.7832002677512584`*^9, 
   3.783200310260253*^9}, {3.7832003458582582`*^9, 3.7832004144662533`*^9}, {
   3.783200782016265*^9, 3.783200786412258*^9}, {3.783200850382252*^9, 
   3.7832008888532515`*^9}, {3.783200925423258*^9, 3.783201254264253*^9}, {
   3.78320144808878*^9, 3.783201483405779*^9}, {3.7832016171087747`*^9, 
   3.7832016619487762`*^9}, {3.7832017011757812`*^9, 
   3.7832018269117813`*^9}, {3.783201882925827*^9, 3.7832018839578223`*^9}, {
   3.783202178252821*^9, 3.7832022468088264`*^9}, {3.7832022912198267`*^9, 
   3.783202478372826*^9}, {3.7832025253798213`*^9, 3.783202752196836*^9}, {
   3.7832028077825084`*^9, 3.7832028630725117`*^9}, {3.78320292590651*^9, 
   3.783202929431509*^9}, {3.783202981826516*^9, 3.7832030131735096`*^9}, {
   3.783203059843506*^9, 3.7832031480385094`*^9}, {3.7832032375955114`*^9, 
   3.783203240375512*^9}, {3.7832034314665084`*^9, 3.7832035627935123`*^9}, {
   3.7832036182985053`*^9, 3.783203657832508*^9}, {3.7832037367855062`*^9, 
   3.783203742038511*^9}, {3.783203812590506*^9, 3.7832038657205048`*^9}, {
   3.783204158625509*^9, 3.783204161460509*^9}, {3.7832047381994295`*^9, 
   3.783204844699428*^9}, {3.7832048915134277`*^9, 3.783205087014431*^9}, {
   3.783205124572427*^9, 3.7832051890894313`*^9}, {3.783205240098427*^9, 
   3.7832054524114285`*^9}, {3.783205484880429*^9, 3.783205533981435*^9}, {
   3.7832055673184247`*^9, 3.7832057277034264`*^9}, {3.7832057652454276`*^9, 
   3.7832058399114313`*^9}, {3.7832058815694275`*^9, 
   3.7832060929734297`*^9}, {3.783206161885426*^9, 3.7832064724044256`*^9}, {
   3.783206516645429*^9, 3.783206517693426*^9}, {3.7832065584704256`*^9, 
   3.783206613238426*^9}, {3.783206659790434*^9, 3.783206799912428*^9}, {
   3.783206865610425*^9, 3.783206929915429*^9}, {3.7832070444314675`*^9, 
   3.7832070580057917`*^9}, 3.7832072496067977`*^9, {3.7832073491438*^9, 
   3.783207350380802*^9}, {3.783207381761804*^9, 3.7832074316312475`*^9}, {
   3.783267930158117*^9, 3.7832681495311193`*^9}, {3.783268278903902*^9, 
   3.7832682873059006`*^9}, {3.7832683234628983`*^9, 
   3.7832683487388983`*^9}, {3.7832684376529016`*^9, 
   3.7832686718248997`*^9}, {3.7832687091059027`*^9, 3.7832687430738993`*^9}, 
   3.783340988568414*^9, {3.7833429070408773`*^9, 3.7833429078998804`*^9}, {
   3.783347777080875*^9, 3.7833477975388727`*^9}, {3.783347833538885*^9, 
   3.783348211197885*^9}, {3.7833482436818695`*^9, 3.783348370996873*^9}, {
   3.7833484201888733`*^9, 3.78334845913787*^9}, {3.7833485244198728`*^9, 
   3.7833485453918705`*^9}, {3.783348608605874*^9, 3.783348719509886*^9}, {
   3.783348759154873*^9, 3.7833488587288857`*^9}, {3.7833489153648853`*^9, 
   3.7833489407099247`*^9}, {3.7833489904909244`*^9, 
   3.7833491754879313`*^9}, {3.783349457948555*^9, 3.7833494646405525`*^9}, {
   3.7833496862180004`*^9, 3.7833498322950087`*^9}, {3.7833555021763506`*^9, 
   3.783355544169341*^9}, {3.7833555743393507`*^9, 3.783355589693348*^9}, 
   3.783355622785347*^9, {3.783355881643176*^9, 3.783355961773361*^9}, {
   3.783356014971366*^9, 3.783356048273364*^9}, 3.783356084366366*^9, {
   3.783356117022364*^9, 3.7833561370653653`*^9}, {3.7833641067871075`*^9, 
   3.7833641349719305`*^9}, 3.783364259308261*^9, {3.7833643182953978`*^9, 
   3.7833643479979277`*^9}, {3.783364379319155*^9, 3.783364490461982*^9}, {
   3.7833645736384716`*^9, 3.7833645865249634`*^9}, {3.7833646224548583`*^9, 
   3.7833646768404446`*^9}, {3.7833647380635977`*^9, 3.783364741403664*^9}, {
   3.7833648241193533`*^9, 3.7833648783402867`*^9}, {3.7833649109500704`*^9, 
   3.78336499079743*^9}, {3.7833651139664884`*^9, 3.7833652092854433`*^9}, 
   3.783365365246479*^9, {3.783365425060472*^9, 3.7833654662861676`*^9}, {
   3.783365673344178*^9, 3.783365716011001*^9}, {3.7833657507071667`*^9, 
   3.783365762010996*^9}, {3.783365793699174*^9, 3.78336586746395*^9}, 
   3.7833659589710836`*^9, {3.783366067354102*^9, 3.78336609019503*^9}, {
   3.783366325377898*^9, 3.7833664630854783`*^9}, {3.7833665141059723`*^9, 
   3.783366529789011*^9}, {3.78336656424378*^9, 3.783366665661471*^9}, {
   3.783366702026165*^9, 3.7833667222291327`*^9}, {3.7833667621183867`*^9, 
   3.783366786767144*^9}, {3.783366977238531*^9, 3.7833669777801175`*^9}, {
   3.7833670490893154`*^9, 3.7833671355529933`*^9}, {3.783367183470787*^9, 
   3.783367289455223*^9}, {3.7833673255675645`*^9, 3.7833673259994593`*^9}, {
   3.7833673834397264`*^9, 3.7833674302555094`*^9}, {3.7833674885764294`*^9, 
   3.7833675672459955`*^9}, {3.7833676458167562`*^9, 3.783367742159035*^9}, {
   3.7833677723502216`*^9, 3.783367772806038*^9}, {3.783367805389821*^9, 
   3.783367805924429*^9}, {3.783367886342269*^9, 3.7833680507144885`*^9}, {
   3.7833680958796487`*^9, 3.7833681433725777`*^9}, {3.7833681923285265`*^9, 
   3.783368219783081*^9}, {3.783368263096186*^9, 3.7833682631689796`*^9}, {
   3.783368303215808*^9, 3.783368323463631*^9}, {3.7833683602402735`*^9, 
   3.7833683607828226`*^9}, {3.7833684118641443`*^9, 3.78336842015897*^9}, {
   3.7833685321952047`*^9, 3.783368532661955*^9}, {3.78336866632734*^9, 
   3.783368704719571*^9}, {3.783368805654556*^9, 3.7833688204639435`*^9}, {
   3.7833688659233055`*^9, 3.7833688852685347`*^9}, {3.7833689671155233`*^9, 
   3.783368968206604*^9}, 3.7833690526387053`*^9, 3.783369114744246*^9, {
   3.783369799208643*^9, 3.783369799563693*^9}, {3.783420770571475*^9, 
   3.783420813092512*^9}, {3.783420868373605*^9, 3.7834208945007124`*^9}, {
   3.783421037599843*^9, 3.78342104580494*^9}, {3.7834212218558636`*^9, 
   3.783421308062255*^9}, {3.7834217310073705`*^9, 3.7834218896858253`*^9}, 
   3.783421921215515*^9, {3.783421997864387*^9, 3.7834223440332065`*^9}, 
   3.7834223971598845`*^9, {3.783422459446241*^9, 3.78342248465479*^9}, {
   3.783422539954836*^9, 3.7834228390775223`*^9}, {3.7834228874331946`*^9, 
   3.783422900528113*^9}, {3.783422948143712*^9, 3.783423006508606*^9}, {
   3.7834230374148703`*^9, 3.7834231374980917`*^9}, 3.78342319336761*^9, {
   3.7834232459120283`*^9, 3.783423255135394*^9}, {3.7834232875037775`*^9, 
   3.783423400461561*^9}, {3.78342343387816*^9, 3.7834235293330007`*^9}, {
   3.7834272401509085`*^9, 3.7834272573072205`*^9}, {3.7834301405966277`*^9, 
   3.783430192504634*^9}, {3.7834302352366314`*^9, 3.783430261140629*^9}, {
   3.783430403900622*^9, 3.78343071712613*^9}, {3.783430752386227*^9, 
   3.7834307554100685`*^9}, {3.7834309595180745`*^9, 
   3.7834309991620684`*^9}, {3.783431029678068*^9, 3.78343117546846*^9}, {
   3.783431208320463*^9, 3.7834315168121862`*^9}, {3.7834317640392313`*^9, 
   3.783431822703231*^9}, {3.7834318549512315`*^9, 3.7834318646192303`*^9}, {
   3.7834318959152308`*^9, 3.7834319901552305`*^9}, {3.783432021699231*^9, 
   3.7834320846432333`*^9}, {3.783432116447241*^9, 3.7834321166192303`*^9}, {
   3.7834321686472273`*^9, 3.783432226795225*^9}, {3.783432261589514*^9, 
   3.7834322962571077`*^9}, {3.7835507305641727`*^9, 3.783550731520171*^9}, 
   3.7835507674921703`*^9, {3.783550871825183*^9, 3.7835508800451837`*^9}, {
   3.784409831716625*^9, 3.7844098573216295`*^9}, {3.7844100421086082`*^9, 
   3.7844100432136235`*^9}, {3.7844103880246267`*^9, 
   3.7844103931506224`*^9}, {3.784410439412628*^9, 3.78441045417663*^9}, 
   3.784410534396623*^9},
 CellLabel->
  "In[187]:=",ExpressionUUID->"08c7442e-dcc5-4f9b-9c98-f46f8741756d"],

Cell[BoxData["98.0952380952381`"], "Output",
 CellChangeTimes->{
  3.783551598832615*^9, {3.784409870747613*^9, 3.784409877469621*^9}, {
   3.7844104553606234`*^9, 3.7844104657386203`*^9}, {3.7844105361806235`*^9, 
   3.784410547208622*^9}, {3.784410584331627*^9, 3.7844105949386206`*^9}},
 CellLabel->
  "Out[193]=",ExpressionUUID->"f158a596-359a-4ca0-aa68-04e4c61ffdb8"]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 para Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 16293, 303, 656, "Input",ExpressionUUID->"08c7442e-dcc5-4f9b-9c98-f46f8741756d"],
Cell[16876, 327, 372, 6, 32, "Output",ExpressionUUID->"f158a596-359a-4ca0-aa68-04e4c61ffdb8"]
}, Open  ]]
}
]
*)

